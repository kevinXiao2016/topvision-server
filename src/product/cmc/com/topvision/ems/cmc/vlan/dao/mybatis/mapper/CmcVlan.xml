<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.topvision.ems.cmc.vlan.domain.CmcVlan"><!-- 	<typeAlias alias="cmcIpSubVlanScalarObject"		type="com.topvision.ems.cmc.facade.domain.CmcIpSubVlanScalarObject" />	<typeAlias alias="cmcIpSubVlanCfgEntry"		type="com.topvision.ems.cmc.facade.domain.CmcIpSubVlanCfgEntry" />	<typeAlias alias="cmcVlanConfigEntry"		type="com.topvision.ems.cmc.facade.domain.CmcVlanConfigEntry" />	<typeAlias alias="cmcVlanPrimaryIp"		type="com.topvision.ems.cmc.facade.domain.CmcVlanPrimaryIp" />	<typeAlias alias="cmcVifSubIpEntry"		type="com.topvision.ems.cmc.facade.domain.CmcVifSubIpEntry" />	<typeAlias alias="cmcVlanDhcpAllocEntry"		type="com.topvision.ems.cmc.facade.domain.CmcVlanDhcpAllocEntry" /> -->					<insert id="insertCmcIpSubVlanScalar" parameterType="cmcIpSubVlanScalarObject">		INSERT	INTO cmcipsubvlanscalar (cmcId, topCcmtsIpSubVlanCfi, topCcmtsIpSubVlanTpid) VALUES 		(#{cmcId}, #{topCcmtsIpSubVlanCfi}, #{topCcmtsIpSubVlanTpid})	</insert>		<select id="getCmcIpSubVlanScalarByCmcId" parameterType="long" resultType="cmcIpSubVlanScalarObject">		select cmcId,topCcmtsIpSubVlanCfi,topCcmtsIpSubVlanTpid from cmcipsubvlanscalar where cmcId = #{cmcId}	</select>	<update id="updateCmcIpSubVlanScalar" parameterType="cmcIpSubVlanScalarObject">		UPDATE		cmcipsubvlanscalar		SET topCcmtsIpSubVlanCfi = #{topCcmtsIpSubVlanCfi},		topCcmtsIpSubVlanTpid = #{topCcmtsIpSubVlanTpid}		WHERE cmcId = #{cmcId}	</update>		<delete id="deleteCmcIpSubVlanScalar" parameterType="cmcIpSubVlanScalarObject">		delete from cmcipsubvlanscalar where cmcId=#{cmcId}	</delete>		<select id="getCmcIpSubVlanCfgList" parameterType="map" resultType="cmcIpSubVlanCfgEntry">		select cmcId,topCcmtsIpSubVlanIfIndex,topCcmtsIpSubVlanIpIndex,topCcmtsIpSubVlanIpMaskIndex,		topCcmtsIpSubVlanVlanId,topCcmtsIpSubVlanPri		from cmcipsubvlancfgentry		where cmcId = #{cmcId}		<if test="sort != null and dir != null">			<choose>				<when test="sort == 'topCcmtsIpSubVlanIpIndex'.toString()">					ORDER BY inet_aton(topCcmtsIpSubVlanIpIndex) ${dir}				</when>				<when test="sort == 'topCcmtsIpSubVlanIpMaskIndex'.toString()">					ORDER BY inet_aton(topCcmtsIpSubVlanIpMaskIndex) ${dir}				</when>				<otherwise>					order by ${sort} ${dir}				</otherwise>			</choose>		</if>	</select>	<select id="getCmcIpSubVlanCfg" parameterType="map"		resultType="cmcIpSubVlanCfgEntry">		select		cmcId,topCcmtsIpSubVlanIfIndex,topCcmtsIpSubVlanIpIndex,topCcmtsIpSubVlanIpMaskIndex,		topCcmtsIpSubVlanVlanId,topCcmtsIpSubVlanPri		from cmcipsubvlancfgentry		where cmcId = #{cmcId} and topCcmtsIpSubVlanIpIndex = #{cmcVlanIpIndex}		and topCcmtsIpSubVlanIpMaskIndex = #{cmcVlanIpMaskIndex}	</select>	<insert id="insertCmcIpSubVlanCfgEntry" parameterType="cmcIpSubVlanCfgEntry">		INSERT		INTO cmcipsubvlancfgentry (cmcId, topCcmtsIpSubVlanIfIndex,		topCcmtsIpSubVlanIpIndex,topCcmtsIpSubVlanIpMaskIndex,		topCcmtsIpSubVlanVlanId,topCcmtsIpSubVlanPri) VALUES (#{cmcId},		#{topCcmtsIpSubVlanIfIndex}, #{topCcmtsIpSubVlanIpIndex},		#{topCcmtsIpSubVlanIpMaskIndex},#{topCcmtsIpSubVlanVlanId},#{topCcmtsIpSubVlanPri})	</insert>	<update id="updateCmcIpSubVlanCfgEntry" parameterType="cmcIpSubVlanCfgEntry">		UPDATE		cmcipsubvlancfgentry		SET topCcmtsIpSubVlanPri = #{topCcmtsIpSubVlanPri}		WHERE cmcId = #{cmcId} and topCcmtsIpSubVlanIpIndex =		#{topCcmtsIpSubVlanIpIndex}		and topCcmtsIpSubVlanIpMaskIndex =		#{topCcmtsIpSubVlanIpMaskIndex}	</update>	<delete id="deleteCmcIpSubVlanCfg" parameterType="map">		delete from		cmcipsubvlancfgentry where cmcId=#{cmcId} and topCcmtsIpSubVlanIpIndex		= #{cmcVlanIpIndex}		and topCcmtsIpSubVlanIpMaskIndex =		#{cmcVlanIpMaskIndex}	</delete>	<delete id="deleteAllCmcIpSubVlanCfg" parameterType="long">		delete from		cmcipsubvlancfgentry where cmcId=#{cmcId}	</delete>	<select id="getCmcVlanList" parameterType="long" resultType="cmcVlanConfigEntry">		select cmcId,topCcmtsVlanIndex,topCcmtsVlanName,topCcmtsTaggedPort,topCcmtsUntaggedPort,topCcmtsVlanFloodMode,		topCcmtsVifPriIpAddr ipAddr,topCcmtsVifPriIpMask ipMask,		topCcmtsVlanDhcpAlloc dhcpAlloc,topCcmtsOption60 option60,		topCcmtsVlanDhcpAllocIpAddr dhcpAllocIpAddr,topCcmtsVlanDhcpAllocIpMask		from cmcvlanconfigentry where cmcId = #{cmcId} and topCcmtsVlanIndex != 0	</select>		<select id="getCmcVlanCfgById" parameterType="map" resultType="cmcVlanConfigEntry">		select cmcId,topCcmtsVlanIndex,topCcmtsVlanName,topCcmtsTaggedPort,topCcmtsUntaggedPort,topCcmtsVlanFloodMode,		topCcmtsVifPriIpAddr ipAddr,topCcmtsVifPriIpMask ipMask,		topCcmtsVlanDhcpAlloc dhcpAlloc,topCcmtsOption60 option60,		topCcmtsVlanDhcpAllocIpAddr dhcpAllocIpAddr,topCcmtsVlanDhcpAllocIpMask dhcpAllocIpMask		from cmcvlanconfigentry where cmcId = #{cmcId} and topCcmtsVlanIndex = #{topCcmtsVlanIndex}	</select>	<select id="getCmcVlanListFromVlan0" parameterType="long"		resultType="cmcVifSubIpEntry">		select cmcId, topCcmtsVifSubIpVlanIdx, topCcmtsVifSubIpSeqIdx,		topCcmtsVifSubIpAddr,		topCcmtsVifSubIpMask		from		cmcvifsubipentry		where cmcId = #{cmcId} and topCcmtsVifSubIpVlanIdx = 0 AND 		topCcmtsVifSubIpAddr NOT IN (select vlanPrimaryDefaultIpAddr from cmcvlanprimaryinterface where cmcId=#{cmcId})	</select>	<insert id="insertCmcVlanCfgEntry" parameterType="cmcVlanConfigEntry">		INSERT INTO		cmcvlanconfigentry (cmcId, topCcmtsVlanIndex) VALUES (#{cmcId},		#{topCcmtsVlanIndex})	</insert>	<delete id="deleteCmcVlanCfgEntry" parameterType="cmcVlanConfigEntry">		delete from		cmcvlanconfigentry where cmcId=#{cmcId} and topCcmtsVlanIndex =		#{topCcmtsVlanIndex}	</delete>		<delete id="deleteAllCmcVlanCfgEntry" parameterType="long">		delete from		cmcvlanconfigentry where cmcId=#{cmcId}	</delete>		<update id="updateCmcVlanPriIp" parameterType="cmcVlanPrimaryIp">		UPDATE	cmcvlanconfigentry		SET topCcmtsVifPriIpAddr = #{topCcmtsVifPriIpAddr},topCcmtsVifPriIpMask=#{topCcmtsVifPriIpMask},topCcmtsVlanDhcpAlloc = 2		WHERE cmcId = #{cmcId} and topCcmtsVlanIndex = #{topCcmtsVifPriIpVlanId} 	</update>		<delete id="deleteCmcVlanSecIpBypriIp" parameterType="map">		delete from		CmcVifSubIpEntry where cmcId=#{cmcId} and topCcmtsVifSubIpVlanIdx=#{vlanId}	</delete>		<insert id="insertCmcVifSubIp" parameterType="cmcVifSubIpEntry">		INSERT	INTO CmcVifSubIpEntry (cmcId, topCcmtsVifSubIpVlanIdx,topCcmtsVifSubIpSeqIdx,topCcmtsVifSubIpAddr,topCcmtsVifSubIpMask) 		VALUES (#{cmcId}, #{topCcmtsVifSubIpVlanIdx},#{topCcmtsVifSubIpSeqIdx},#{topCcmtsVifSubIpAddr},#{topCcmtsVifSubIpMask})	</insert>		<select id="getCmcVlanPriIpList" parameterType="long" resultType="cmcVlanPrimaryIp">		select cmcId,topCcmtsVlanIndex topCcmtsVifPriIpVlanId,topCcmtsVifPriIpAddr,topCcmtsVifPriIpMask		from cmcvlanconfigentry where cmcId = #{cmcId} and topCcmtsVlanIndex != 0	</select>		<select id="getCmcVlanVisIpList" parameterType="long" resultType="cmcVifSubIpEntry">		select cmcId,topCcmtsVifSubIpVlanIdx,topCcmtsVifSubIpSeqIdx,topCcmtsVifSubIpAddr,topCcmtsVifSubIpMask		from cmcvifsubipentry where cmcId = #{cmcId} and topCcmtsVifSubIpVlanIdx != 0	</select>		<delete id="deleteCmcVlanSubIP" parameterType="cmcVifSubIpEntry">		delete from cmcvifsubipentry where cmcId=#{cmcId} and topCcmtsVifSubIpVlanIdx = #{topCcmtsVifSubIpVlanIdx} and topCcmtsVifSubIpSeqIdx = #{topCcmtsVifSubIpSeqIdx}	</delete>		<delete id="deleteAllCmcSubIpByVlan" parameterType="map">		delete from cmcvifsubipentry where cmcId=#{cmcId} and topCcmtsVifSubIpVlanIdx = #{topCcmtsVifSubIpVlanIdx}	</delete>		<delete id="deleteAllCmcVlanSubIP" parameterType="long">		delete from cmcvifsubipentry where cmcId=#{cmcId}	</delete>		<update id="updateCmcVlanPriIpDhcpCfg" parameterType="cmcVlanDhcpAllocEntry">		UPDATE	cmcvlanconfigentry		SET topCcmtsVlanDhcpAlloc = #{topCcmtsVlanDhcpAlloc},topCcmtsOption60=#{topCcmtsOption60},		topCcmtsVlanDhcpAllocIpAddr = #{topCcmtsVlanDhcpAllocIpAddr},topCcmtsVlanDhcpAllocIpMask = #{topCcmtsVlanDhcpAllocIpMask}		WHERE cmcId = #{cmcId} and topCcmtsVlanIndex = #{topCcmtsVlanIndex} 	</update>		<update id="updateCmcVlanSubIp" parameterType="cmcVifSubIpEntry">		UPDATE	cmcvifsubipentry		SET topCcmtsVifSubIpAddr = #{topCcmtsVifSubIpAddr},topCcmtsVifSubIpMask = #{topCcmtsVifSubIpMask}		WHERE cmcId = #{cmcId} and topCcmtsVifSubIpVlanIdx = #{topCcmtsVifSubIpVlanIdx} and topCcmtsVifSubIpSeqIdx = #{topCcmtsVifSubIpSeqIdx}	</update>		<select id="getCmcVlanVisIpIndexList" parameterType="long" resultType="int">		select topCcmtsVifSubIpSeqIdx		from cmcvifsubipentry where cmcId = #{cmcId}	</select>		<select id="queryCmcVlanPriIp" parameterType="map" resultType="cmcVlanConfigEntry">		select * from cmcvlanconfigentry		where cmcId = #{cmcId} and  topCcmtsVlanDhcpAlloc != 1 and ((topCcmtsVifPriIpAddr = #{cmcVlanIp})		 or (topCcmtsVlanDhcpAllocIpAddr = #{cmcVlanIp}  		))	</select>		<select id="queryCmcVlanSubIp" parameterType="map" resultType="cmcVifSubIpEntry">		select * from cmcvifsubipentry		where cmcId = #{cmcId} and topCcmtsVifSubIpAddr = #{cmcVlanIp} 	</select>	</mapper>